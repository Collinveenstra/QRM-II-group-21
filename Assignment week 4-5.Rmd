---
title: "QRM II Graded Assignment (2), Period 1 2025"
subtitle: "Material by Sjoerd van Alten and Klervie Toczé"
author: "Group 21 - Carlijn Calori, Julia Koeleman, Marit Springer & Collin Veenstra"
date:  "`r format(Sys.Date(), '%d-%m-%Y')`"
output:
  word_document:
  html_document:
    df_print: paged
  pdf_document:
    number_sections: true
header-includes:
- "\\setcounter{section}{-1}"
- |
  \usepackage{fvextra}
  \DefineVerbatimEnvironment{Highlighting}{Verbatim}{
    showspaces = false,
    showtabs = false,
    breaklines,
    commandchars=\\\{\}
format:
  html:
    code-overflow: wrap
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Week 4 

1. There is another argument going on in the movie studio. *Bob* claims that production budgets are getting out of hand, and that the studio should focus on making cheaper movies. *Chantal* disagrees. She tells Bob that ``Every dollar we spend on movie production is more than offset by the increase in movie profits''. 

a. Set up a regression model to test Chantal's claim, and estimate it. That is, estimate: $$\text{Profits}_i=\beta_0+\beta_1 \text{Budget}_i +\varepsilon_i.$$ Print a summary of your estimated model. \textbf{[2 points]}
b. What is the estimated value of $\beta_1$ and how do you interpet it? \textbf{[2 points]}
c. Test for the null hypothesis that $\beta_1 \geq 0$. Report the p-value and state your conclusion. \textbf{[2 points]} 
d. Next, estimate the model $$\text{Log Profits}_i=\beta_0+\beta_1 \text{Log Budget}_i +\varepsilon_i.$$ When creating the variables Log Profits and Log Budget, make sure that movies with a Revenue or Budget of zero are assigned the value "NA". Print a summary of your estimated model \textbf{[2 points]}
e. What is the estimated value of $\beta_1$ and how do you interpet it? \textbf{[2 points]}
f. Which model has better fit? The level-level model or the log-log model? Explain. \textbf{[2 points]}
g. Who do you think is correct? Bob or Chantal? What would you advise the movie studio to do? \textbf{[2 points]}

*step a*

```{r}
#WRITE YOUR CODE HERE
movies <- read.table("movies1.tsv", header=TRUE)
movies$profit <- movies$revenue - movies$budget

model_a <- lm(profit ~ budget, data = movies)
summary(model_a)

```

**Your Answer:**

Profit = -1,76x10^7 + 2,547 x Budget. If a movie had a budget of 0, expected profits would be about -17,6 million euros. For every 1 euro increase in budget, expected profits rises by 2,55 euro on average.

*step b*

**Your Answer:**

The estimated value of Beta 1 is 2.547. This means that each additional dollar spent on production, is an increase of 2.547 dollar in profits. 

*step c*

```{r}
#WRITE YOUR CODE HERE
coefs <- summary(model_a)$coefficients
t_val <- coefs["budget", "t value"]

p_value <- pt(t_val, df = model_a$df.residual, lower.tail = TRUE)
print(p_value)
```

**Your Answer:**

H0: B1 >= 0
H1: B1 < 0

Since the p-value is 1, we fail to reject the null hypothesis and conclude there is very strong evidence that B1 >= 0 at any usual a. There is no evidence that the slope is negative. The data strongly suggest that the slope is positive: higher budgets are associated with higher profits.

*step d*

```{r}
#WRITE YOUR CODE HERE
movies$LogProfit <- ifelse(movies$profit > 0, log(movies$profit), NA)
movies$LogBudget <- ifelse(movies$budget > 0, log(movies$budget), NA)

model_log <- lm(LogProfit ~ LogBudget, data = movies)
summary(model_log)
```

**Your Answer:**

LogProfit = 6,12 + 0.67 x LogBudget. When LogBudget is 0, expected profits are about 6.12 

*step e*

**Your Answer:**

The estimated value of Beta 1 is 0,67348. Since this is a log-log model, a 1% increase in budget is associated with an estimated 0,673% increase in profits, on average. This indicates that there are diminishing marginal returns on budget.

*step f*

**Your Answer:**

The level–level model fits the data better since it has a higher R^2:
Level R^2 = 0.4322
Log R^2 = 0.3201

The level–level model clearly has the best statistical fit. This model is suitable if you are interested in absolute effects. The log–log model, on the other hand, has a lower fit, but is often more meaningful economically because it can be interpreted in terms of elasticities: a 1% increase in budget is associated with a 0.67% increase in profit.

*step g*

**Your Answer:**

Chantal is correct in the sense that, at the margin, the studio currently gets back more than 1 dollar in profits for every extra dollar spent, because B1 is 3,547. The level–level model supports her argument directly.

Bob has a point too: the log–log model shows diminishing returns, because B1 is 0.673. So Bob’s concern is not entirely unfounded. I would advise the studio to keep investing in production budgets but to be cautious with spending too much on very large projects, focusing instead on the range of budgets where returns are strongest.

2
a. Make a plot with a 95% confidence interval with the mean log of budget on the y-axis, and whether the first actor of the movie is male or female on the x-axis. What do you conclude? \textbf{[2 points]} 
b. Estimate the following simple OLS model: $log(budget)_i=\beta_0+\beta_1 \text(FirstActorMale)_i + \varepsilon_i.$ Is the estimated coefficient for $\beta_1$ significantly different from zero? How do you interpret its estimate, and how does this relate to your conclusion in 2a? \textbf{[2 points]}
c. Now, have a close look at your data frame. Can you find any instances of male first actors who are wrongly labeled as being female, or vice versa? What would such mislabelling mean for the coefficient you estimated under 2b? \textbf{[2 points]}

*step a*

```{r}
#WRITE YOUR CODE HERE
install.packages("Hmisc", repos = "https://cloud.r-project.org")
library (tidyverse)
library (Hmisc)

movies <- subset(movies, budget >0)
movies$log_budget <- log(movies$budget)

ggplot(movies, aes(x = first_actor_gender, y = log_budget)) +
  stat_summary(fun = mean, geom = "point", size = 3) +
  stat_summary(fun.data = mean_cl_normal, geom = "errorbar", width = 0.2) +
  labs(x = "Gender of First Actor", y = "Mean Log of Budget",
       title = "Mean Log of Budget by First Actor Gender with 95% Confidence Interval")
```

**Your Answer:**

This plot shows that the average log-budget of films with a male first actor is slightly higher than that of films with a female first actor, but there is a large overlap of confidence intervals. This means there is no clear statistical difference between the groups. For the NA group, the uncertainty is so large that no conclusion can be drawn.

*step b*

```{r}
#WRITE YOUR CODE HERE
model_b <- lm(log_budget ~ movies$first_actor_gender, data = movies,)
summary(model_b)

percent_effect <- (exp(0.3232)-1)*100
print(percent_effect)

```

**Your Answer:**

The estimated coefficient for β1 is 0.3232 with a p-value of 0.194, so it is not significantly different from zero. This is because 0.194 > 0.05. This means we cannot conclude that movies with a male first actor have different budgets than those with a female first actor. The positive estimate would suggest about a 38% higher budget for male leads, but since it’s not significant, this difference is not reliable. This matches our conclusion in 2a: There is no significant difference in mean log-budgets between male and female first actors.

*step c*

**Your Answer:**

We have detected some wrongly labeled actors. Some examples are: Cameron Diaz, Jackie Chan and Blake Lively. Because some actors are wrongly labeled as male or female, the data contains errors. This makes the estimated coefficient for β1 biased towards zero. The true effect of actor gender would be underestimated because mislabeling makes the variable noisier. As a result, any real difference in budgets between male and female leads becomes harder to see.

# Week 5

a. Create a plot of the mean profits by month of release. Do you see any indication that month of release matters to the profits of the movie? \textbf{[2 points]}
b. Estimate an OLS model which has as dependent variable the log of profits of a movie, and as independent variable the log of budget, a dummy for whether the movie was released in english or not, and a linear term for the month of release. Show a summary of the resulting model and interpret each coefficient. \textbf{[4 points]}
c. Test for the hypothesis that the coefficient that belongs to month of release is zero. \textbf{[2 points]} 
  d. Based on your plot in a.) do you consider the choice that month of release enters the model linearly under b.) reasonable? Estimate a specification that allows for a more flexible curve. In this new specification, test for the null hypothesis that month of release does not impact profits. This might require testing multiple terms at once. \textbf{[4 points]}

e. One executive at the studio wants to time the release of the movie to a specific month of the year such that they can maximize revenue. Based on your model under d.), What would you advise the movie studio regarding the timing of the release of the movie?  \textbf{[2 points]}

The movie studio that you work at is releasing a new movie in 2026. It will be an English-spoken Thriller movie with a budget of 40,000,0000. 

f. Estimate a model that is able to predict the revenue of this movie. Give its predicted revenue and include a 99% prediction interval.  \textbf{[6 points]}


*step a*

```{r}
#WRITE YOUR CODE HERE
library(tidyverse)

profits_by_month<- movies %>% 
  group_by(release_month) %>% 
  summarise(meanprofit=mean(profit,na.rm=T))
ggplot(profits_by_month, aes(x=factor(release_month), y=meanprofit))+
  geom_col(fill="blue")+
  labs(
    title="Average profit per month of release", 
    x="Release month",
    y="Average profit"
  )
```

**Your Answer:**

The month of release definitely matters. It is better to release the movie in April, June or December, because those months generated the most profit. January, February, August and September generated the least profit, so the movie should not be released in those months.

*step b*

```{r}
#WRITE YOUR CODE HERE
movies$english <- ifelse(movies$original_language == "en", 1, 0)
movies$english<- as.factor(movies$english)

model_5b<- lm(LogProfit ~ LogBudget + english + release_month, data=movies)
summary(model_5b)

percentage_effect <- (exp(-0.66377)-1)*100
percentage_effect
```

**Your Answer:**

LogProfit = 6,531 + 0,681 x LogBudget - 0,664 x English + 0.015 x Release Month

An increase of 1% in budget, increases the revenue with 0.681%.
English movies have an estimated 48,51% lower revenue than non-English movies.
For each month later in the year, the revenue is 1.5% higher if the rest is constant.

*step c*

**Your Answer:**
H0: B3 = 0
H1: B3 ≠ 0

If you look at the release month, the t value is 0.572 and the p value is 0.568.
The p value is much larger than any significance level (0.1, 0.05 etc.), so we fail to reject the null hypothesis. Thus, there is no statistically significant evidence that the release month affects movie revenues, keeping other variables constant.

*step d*

```{r}
#WRITE YOUR CODE HERE

model_flex <- lm(LogProfit ~ LogBudget + english + as.factor(release_month), data = movies)
summary(model_flex)

anova(model_5b, model_flex)
```

**Your Answer:**

There are strong seasonal peaks, which causes a non-linear relationship. Therefore a simple linear trend of: later month leads to higher profits, is incorrect. So the assumption in part b that month enters linearly is not reasonable.

In the new model the reference category is January (month 1). All other coefficients are differences in log profit relative to January, holding budget and language constant.

H0: all months coefficient = 0
H1: at least one month coefficient ≠ 0

The hypothesis test gives:
F = 1,5655    p-value = 0.01176

Since the p-value 0.0118 is above 0.05, we fail to reject the null at the 5% level. Statistically there is no strong evidence that the month of release affects log profits keeping other variables constant.

Although the plot suggested strong seasonality, the release month is not statistically strong enough to be significant at the 5% level.

*step e*

**Your Answer:**

I would not advise the studio to time a release solely based on calender month. The regression model provides no strong statistical evidence that releasing in a particular month will reliably increase log profits. 

The raw averages do show peaks in April, June and December, so if the studio insists on using month as a rule of thumb, those months have historically higher average profits. But as said before the advantage from picking a particular month is uncertain and may be driven by other factors (bigger budget-films tend to be released in those months).

Advise is to focus on budget and other factors as marketing strategy or competition, rather than relying on month alone.

*step f*

```{r}
#WRITE YOUR CODE HERE

new_movie <- data.frame(
  LogBudget = log(40000000),
  english = factor(1, levels = levels(movies$english)),
  release_month = factor(1, levels = 1:12)
)

prediction <- predict(model_flex, newdata = new_movie, interval = "prediction", level = 0.99)
exp(prediction)
```

**Your Answer:**

The predicted revenue is about 77,75 million dollar. The 99% prediction interval is very wide reaching from about 1,71 million dollar up to 3,54 billion dollar. This wide interval shows the high uncertainty in movie success: while the model predicts a healthy profit, outcomes could range from a flop to an extreme blockbuster
