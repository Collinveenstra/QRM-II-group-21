---
---
title: "QRM II Graded Assignment (2), Period 1 2025"
subtitle: "Material by Sjoerd van Alten and Klervie Toczé"
author: "Fill in your group number and names here"
date:  "`r format(Sys.Date(), '%d-%m-%Y')`"
output:
  html_document:
    df_print: paged
  pdf_document:
    number_sections: true
header-includes:
- "\\setcounter{section}{-1}"
- |
  \usepackage{fvextra}
  \DefineVerbatimEnvironment{Highlighting}{Verbatim}{
    showspaces = false,
    showtabs = false,
    breaklines,
    commandchars=\\\{\}
format:
  html:
    code-overflow: wrap
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Week 4 

1. There is another argument going on in the movie studio. *Bob* claims that production budgets are getting out of hand, and that the studio should focus on making cheaper movies. *Chantal* disagrees. She tells Bob that ``Every dollar we spend on movie production is more than offset by the increase in movie profits''. 

a. Set up a regression model to test Chantal's claim, and estimate it. That is, estimate: $$\text{Profits}_i=\beta_0+\beta_1 \text{Budget}_i +\varepsilon_i.$$ Print a summary of your estimated model. \textbf{[2 points]}
b. What is the estimated value of $\beta_1$ and how do you interpet it? \textbf{[2 points]}
c. Test for the null hypothesis that $\beta_1 \geq 0$. Report the p-value and state your conclusion. \textbf{[2 points]} 
d. Next, estimate the model $$\text{Log Profits}_i=\beta_0+\beta_1 \text{Log Budget}_i +\varepsilon_i.$$ When creating the variables Log Profits and Log Budget, make sure that movies with a Revenue or Budget of zero are assigned the value "NA". Print a summary of your estimated model \textbf{[2 points]}
e. What is the estimated value of $\beta_1$ and how do you interpet it? \textbf{[2 points]}
f. Which model has better fit? The level-level model or the log-log model? Explain. \textbf{[2 points]}
g. Who do you think is correct? Bob or Chantal? What would you advise the movie studio to do? \textbf{[2 points]}

*step a*

```{r}
#WRITE YOUR CODE HERE
movies <- read.table("movies1.tsv", header=TRUE)

model <- lm(revenue ~ budget, data = movies)
summary(model)

```

**Your Answer:**

Profit = -1,76x10^7 + 3,547 x Budget. If a movie had a budget of 0, expected profits would be about -17,6 million euros. For every 1 euro increase in budget, expected profits rise by 3,55 euro on average.

*step b*

```{r}
#WRITE YOUR CODE HERE
summary(model)
```

**Your Answer:**

The estimated value of Beta 1 is 3.547. This means that each additional dollar spent on production, is an increase of 3.547 dollar in profits. 

*step c*

```{r}
#WRITE YOUR CODE HERE
coefs <- summary(model)$coefficients
t_val <- coefs["budget", "t value"]

p_value <- pt(t_val, df = model$df.residual, lower.tail = FALSE)
print(p_value)
```

**Your Answer:**

H0: B1 <= 0
H1: B1 > 0

Since the p-value is essentially 0 (2,1x10^-101), we reject the null hypothesis and conclude there is very strong evidence that B1 > 0.
This means higher budgets are associated with significantly higher profits

*step d*

```{r}
#WRITE YOUR CODE HERE
movies$profit <- movies$revenue - movies$budget

movies$LogProfit <- ifelse(movies$profit > 0, log(movies$profit), NA)
movies$LogBudget <- ifelse(movies$budget > 0, log(movies$budget), NA)

model_log <- lm(LogProfit ~ LogBudget, data = movies)
summary(model_log)
```

**Your Answer:**

LogProfit = 6,12 + 0.67 x LogBudget. 

*step e*

```{r}
#WRITE YOUR CODE HERE

```

**Your Answer:**

The estimated value of Beta 1 is 0,67348. Since this is a log-log model, a 1% increase in budget is associated with an estimated 0,673% increase in profits, on average.

*step f*

```{r}
#WRITE YOUR CODE HERE

```

**Your Answer:**

The level–level model fits the data better since it has a higher R^2:
Level R^2 = 0.5961
Log R^2 = 0.3201

The level–level model clearly has the best statistical fit. This model is suitable if you are interested in absolute effects. The log–log model, on the other hand, has a lower fit, but is often more meaningful economically because it can be interpreted in terms of elasticities: a 1% increase in budget is associated with a 0.67% increase in profit. Only problem is that it ignores negative numbers.

*step g*

```{r}
#WRITE YOUR CODE HERE

```

**Your Answer:**

Chantal is correct in the sense that, at the margin, the studio currently gets back more than 1 dollar in profits for every extra dollar spent, because B1 is 3,547. The level–level model supports her argument directly.

Bob has a point too: the log–log model shows diminishing returns, because B1 is 0.673. So Bob’s concern is not entirely unfounded. I would advise the studio to keep investing in production budgets but to be cautious with spending too much on very large projects, focusing instead on the range of budgets where returns are strongest.

2
a. Make a plot with a 95% confidence interval with the mean log of budget on the y-axis, and whether the first actor of the movie is male or female on the x-axis. What do you conclude? \textbf{[2 points]} 
b. Estimate the following simple OLS model: $log(budget)_i=\beta_0+\beta_1 \text(FirstActorMale)_i + \varepsilon_i.$ Is the estimated coefficient for $\beta_1$ significantly different from zero? How do you interpret its estimate, and how does this relate to your conclusion in 2a? \textbf{[2 points]}
c. Now, have a close look at your data frame. Can you find any instances of male first actors who are wrongly labeled as being female, or vice versa? What would such mislabelling mean for the coefficient you estimated under 2b? \textbf{[2 points]}

*step a*

```{r}
#WRITE YOUR CODE HERE
install.packages("Hmisc")
library (tidyverse)
library (Hmisc)

movies <- subset(movies, budget >0)
movies$log_budget <- log(movies$budget)

ggplot(movies, aes(x = first_actor_gender, y = log_budget)) +
  stat_summary(fun = mean, geom = "point", size = 3) +
  stat_summary(fun.data = mean_cl_normal, geom = "errorbar", width = 0.2) +
  labs(x = "Gender of First Actor", y = "Log of Budget",
       title = "Mean Log of Budget by First Actor Gender with 95% Confidence Interval")
```

**Your Answer:**

This plot shows that the average log-budget of films with a male first actor is slightly higher than that of films with a female first actor, but there is a large overlap of confidence intervals. This means there is no clear statistical difference between the groups. For the NA group, the uncertainty is so large that no conclusion can be drawn.

*step b*

```{r}
#WRITE YOUR CODE HERE
model <- lm(log_budget ~ movies$first_actor_gender, data = movies,)
summary(model)

percent_effect <- (exp(0.3232)-1)*100
print(percent_effect)

```

**Your Answer:**

The estimated coefficient for β1 is 0.3232 with a p-value of 0.194, so it is not significantly different from zero. This is because 0.194 > 0.05. This means we cannot conclude that movies with a male first actor have different budgets than those with a female first actor. The positive estimate would suggest about a 38% higher budget for male leads, but since it’s not significant, this difference is not reliable. This matches your conclusion in 2a: There is no significant difference in mean log-budgets between male and female first actors.

*step c*

```{r}
#WRITE YOUR CODE HERE

```

**Your Answer:**

We have detected some wrongly labeled actors. Some examples are: Cameron Diaz, Jackie Chan and Blake Lively. Because some actors are wrongly labeled as male or female, the data contains errors. This makes the estimated coefficient for β1 smaller than it should be, pushing it closer to zero. As a result, any real difference in budgets between male and female leads becomes harder to see.

# Week 5

a. Create a plot of the mean profits by month of release. Do you see any indication that month of release matters to the profits of the movie? \textbf{[2 points]}
b. Estimate an OLS model which has as dependent variable the log of profits of a movie, and as independent variable the log of budget, a dummy for whether the movie was released in english or not, and a linear term for the month of release. Show a summary of the resulting model and interpret each coefficient. \textbf{[4 points]}
c. Test for the hypothesis that the coefficient that belongs to month of release is zero. \textbf{[2 points]} 
  d. Based on your plot in a.) do you consider the choice that month of release enters the model linearly under b.) reasonable? Estimate a specification that allows for a more flexible curve. In this new specification, test for the null hypothesis that month of release does not impact profits. This might require testing multiple terms at once. \textbf{[4 points]}

e. One executive at the studio wants to time the release of the movie to a specific month of the year such that they can maximize revenue. Based on your model under d.), What would you advise the movie studio regarding the timing of the release of the movie?  \textbf{[2 points]}

The movie studio that you work at is releasing a new movie in 2026. It will be an English-spoken Thriller movie with a budget of 40,000,0000. 

f. Estimate a model that is able to predict the revenue of this movie. Give its predicted revenue and include a 99% prediction interval.  \textbf{[6 points]}


*step a*

```{r}
#WRITE YOUR CODE HERE
library(tidyverse)

profits_by_month<- movies %>% 
  group_by(release_month) %>% 
  summarise(meanrevenue=mean(revenue,na.rm=T))
ggplot(profits_by_month, aes(x=factor(release_month), y=meanrevenue))+
  geom_col(fill="blue")+
  labs(
    title="Average revenue per month", 
    x="Release month",
    y="Average profit"
  )+
  theme_minimal()
```

**Your Answer:**

The month of release matters. It is better to release the movie in months June or December, because those generated the most profit. January and September generated the least profit, so the movie should not release in those months.

*step b*

```{r}
#WRITE YOUR CODE HERE
movies$english <- ifelse(movies$original_language == "en", 1, 0)
movies$english<- as.factor(movies$english)
summary(movies)

movies$LogRevenue <- ifelse(movies$revenue > 0, log(movies$revenue), NA)

movies<- movies[movies$profit>0&movies$budget >0,]

model<- lm(LogRevenue ~ LogBudget + english + release_month, data=movies)
summary(model)
```

**Your Answer:**

LogRevenue = 5,75592 + 0,749 x LogBudget - 0,349 x English + 0.01 x Release Month

An increase of 1% in budget, increases the revenue with 0.749%.
English movies have an estimated 34,9% lower revenue than non-English movies.
For each month later in the year, the revenue is 1.1% higher if the rest is constant.

*step c*

```{r}
#WRITE YOUR CODE HERE
model<- lm(LogRevenue~LogBudget + english+release_month, data=movies)
summary(model)
```

**Your Answer:**
H0: B3 = 0
H1: B3 ≠ 0

If you look at the release month, the t value is 0.791 and the p value is 0.430.
The p value is much larger than 0.05, so we fail to reject the null hypothesus at the 5% significance level. Thus, there is no statistically significant evidence that the release month affects movie revenues, keeping other variables constant.

*step d*

```{r}
#WRITE YOUR CODE HERE

model_flex <- lm(LogRevenue ~ LogBudget + english + as.factor(release_month), data = movies)
summary(model_flex)

anova(model, model_flex)
```

**Your Answer:**

There are strong seasonal peaks, which causes a non-linear relationship. Therefore a simple linear trend of: later month leads to higher profits, is incorrect. So the assumption in part b that month enters linearly is not reasonable.

In the new model the reference category is January (month 1). All other coefficients are differences in log revenue relative to January, holding budget and language constant.

The hypothesis test gives:
F = 1,84    p-value = 0.055

Since the p-value is just above 0.05, we fail to reject the null at the 5% level. This means we cannot conclude that release month has a statistically significant effect on revenues. However, at the 10% level, we would reject the null, suggesting weak evidence that release month might matter. Overall, the evidence for a month effect is marginal, but not strong.

*step e*

```{r}
#WRITE YOUR CODE HERE

```

**Your Answer:**

The joint test (p = 0.055) provides only weak evidence that release month matters. Most months show coefficients close to zero with large p-values, suggesting no effect. Only August and September display relatively large negative coefficients and marginal significance (around 10% interval), hinting at lower revenues in late summer. The studio should not rely on month-timing to boost revenues, although they may want to be cautious about late-summer releases (August/September).

*step f*

```{r}
#WRITE YOUR CODE HERE

new_movie <- data.frame(
  LogBudget = log(40000000),
  english = factor(1, levels = levels(movies$english)),
  release_month = factor(1, levels = 1:12)
)

prediction <- predict(model_flex, newdata = new_movie,
                interval = "prediction", level = 0.99)

exp(prediction)
```
**Your Answer:**

The predicted revenue is about 130 million dollar. The 99% prediction interval is very wide reaching from about 18 million dollar up to 943 million dollar.
